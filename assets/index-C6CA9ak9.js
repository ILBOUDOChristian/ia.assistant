import{r as e,a as t,R as s}from"./vendor-BEmX_Svj.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var a={exports:{}},r={},i=e,n=Symbol.for("react.element"),o=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,c=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function h(e,t,s){var a,r={},i=null,o=null;for(a in void 0!==s&&(i=""+s),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)l.call(t,a)&&!d.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:n,type:e,key:i,ref:o,props:r,_owner:c.current}}r.Fragment=o,r.jsx=h,r.jsxs=h,a.exports=r;var m=a.exports,p={},u=t;p.createRoot=u.createRoot,p.hydrateRoot=u.hydrateRoot;const y=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},g=(...e)=>e.filter((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),f=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var x={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const v=e.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:i="",children:n,iconNode:o,...l},c)=>e.createElement("svg",{ref:c,...x,width:s,height:s,stroke:t,strokeWidth:r?24*Number(a)/Number(s):a,className:g("lucide",i),...!n&&!f(l)&&{"aria-hidden":"true"},...l},[...o.map(([t,s])=>e.createElement(t,s)),...Array.isArray(n)?n:[n]])),j=(t,s)=>{const a=e.forwardRef(({className:a,...r},i)=>{return e.createElement(v,{ref:i,iconNode:s,className:g(`lucide-${n=y(t),n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${t}`,a),...r});var n});return a.displayName=y(t),a},k=j("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),N=j("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]),b=j("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),w=j("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),M=j("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),z=j("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),S=j("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]),C=j("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),O=j("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),_=j("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),R=j("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),E=j("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),D=j("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),A=atob("c2stb3ItdjEtNjQ1MTI5NjgyYzNmMzY3MTg3NWMzZGRiNjNiMmRlNTA1MmQxOTYzOTg3MzIzMjBkMzFkYTBhMDc2N2U3ODE4Nw=="),L=async(e,t)=>{var s,a,r;if(!A)throw new Error("⚠️ Erreur de clé.");const i=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${A}`,"Content-Type":"application/json","HTTP-Referer":"https://ilboudochristian.github.io/ia.assistant","X-Title":"BrandBrain AI"},body:JSON.stringify({model:"openai/gpt-oss-120b:free",messages:e,stream:!0})});if(!i.ok){const e=await i.json().catch(()=>({}));throw new Error(`⚠️ Status System : ${(null==(s=e.error)?void 0:s.message)||i.statusText}`)}const n=i.body.getReader(),o=new TextDecoder("utf-8");let l="";for(;;){const{done:e,value:s}=await n.read();if(e)break;l+=o.decode(s,{stream:!0});const i=l.split("\n");l=i.pop();for(const n of i){const e=n.replace(/^data: /,"").trim();if(e&&"[DONE]"!==e)try{const s=(null==(r=null==(a=JSON.parse(e).choices[0])?void 0:a.delta)?void 0:r.content)||"";s&&t(s)}catch(c){}}}};function T(){const[t,s]=e.useState(()=>{const e=localStorage.getItem("brandbrain_chats_v3");return e?JSON.parse(e):[{id:"1",title:"Nouvelle Discussion",messages:[]}]}),[a,r]=e.useState(()=>{var e;return(null==(e=t[0])?void 0:e.id)||"1"}),[i,n]=e.useState(""),[o,l]=e.useState(!1),[c,d]=e.useState([]),[h,p]=e.useState(""),[u,y]=e.useState(!1),g=e.useRef(null),f=e.useRef(null),x=(t.find(e=>e.id===a)||t[0]).messages;e.useEffect(()=>{localStorage.setItem("brandbrain_chats_v3",JSON.stringify(t))},[t]);const v=e=>{navigator.clipboard.writeText(e)},j=e=>{s(t=>t.map(t=>{if(t.id===a){let s=t.title;return 0===t.messages.length&&e.length>0&&(s=e[0].content.substring(0,30)||"Discussion Image"),{...t,messages:e,title:s}}return t}))},A=async e=>{e.preventDefault();const t=i.trim();if(!t&&!c.length)return;const s={role:"user",content:t,files:c.map(e=>({name:e.name,type:e.type,data:e.data,preview:e.preview})),timestamp:(new Date).toISOString()},a=[...x,s];j(a),n(""),l(!0),p("");try{if((t.toLowerCase().includes("image")||t.toLowerCase().includes("dessin")||t.toLowerCase().includes("photo"))&&0===c.length){const e=[{role:"system",content:"Create an image prompt in English. Output ONLY the prompt."},{role:"user",content:t}];let s="";await L(e,e=>{s+=e});const r=`https://image.pollinations.ai/prompt/${encodeURIComponent(s)}?width=1024&height=1024&seed=${Math.random()}&nologo=true`;j([...a,{role:"assistant",content:"Voici votre illustration marketing :",image:r,timestamp:(new Date).toISOString()}])}else{const e=[{type:"text",text:t}];c.forEach(t=>{t.type.startsWith("image/")&&e.push({type:"image_url",image_url:{url:t.data}})});const s=[{role:"system",content:"Tu es BrandBrain AI. Réponds en texte brut sans markdown ni étoiles. Aide au marketing."},...x.slice(-6).map(e=>({role:e.role,content:e.content})),{role:"user",content:e}];let r="";await L(s,e=>{r+=e,p(r)}),j([...a,{role:"assistant",content:r,timestamp:(new Date).toISOString()}])}}catch(r){j([...a,{role:"assistant",content:"Désolé, une erreur est survenue."}])}finally{l(!1),p(""),d([])}};return m.jsxs("div",{className:"chat-wrapper "+(u?"sidebar-open":""),children:[m.jsx("div",{className:"sidebar-overlay",onClick:()=>y(!1)}),m.jsxs("aside",{className:"chat-sidebar",children:[m.jsxs("button",{onClick:()=>{const e=Date.now().toString();s([{id:e,title:"Nouvelle Discussion",messages:[]},...t]),r(e),y(!1)},className:"sidebar-new-btn",children:[m.jsx(C,{size:16})," Nouvelle discussion"]}),m.jsx("div",{className:"history-list",children:t.map(e=>m.jsxs("div",{className:"history-item "+(a===e.id?"active":""),onClick:()=>{r(e.id),y(!1)},children:[m.jsx(w,{size:14}),m.jsx("span",{children:e.title}),m.jsx("button",{onClick:i=>((e,i)=>{e.stopPropagation();const n=t.filter(e=>e.id!==i);if(0===n.length){const e=[{id:Date.now().toString(),title:"Nouvelle Discussion",messages:[]}];s(e),r(e[0].id)}else s(n),a===i&&r(n[0].id)})(i,e.id),className:"delete-btn",children:m.jsx(D,{size:12})})]},e.id))}),m.jsx("div",{className:"sidebar-footer",children:"ILBOUDO Christian 2026"})]}),m.jsxs("div",{className:"chat-main",children:[m.jsxs("header",{className:"chat-header-v2",children:[m.jsxs("div",{className:"brand",children:[m.jsx("button",{className:"menu-toggle",onClick:()=>y(!0),children:m.jsx(z,{size:24})}),m.jsx(N,{className:"logo",size:24}),m.jsx("h1",{children:"BrandBrain"})]}),m.jsx("button",{className:"refresh-btn",onClick:()=>window.location.reload(),title:"Actualiser",children:m.jsx(O,{size:18})})]}),m.jsxs("main",{className:"chat-feed",children:[0===x.length&&!o&&m.jsxs("div",{className:"empty-state",children:[m.jsx(R,{size:48,className:"icon"}),m.jsx("h2",{children:"Comment puis-je vous aider ?"}),m.jsx("p",{children:"Analysez des fichiers, créez des images ou rédigez vos campagnes."})]}),x.map((e,t)=>{var s;return m.jsxs("div",{className:`message-row ${e.role}`,children:[m.jsx("div",{className:"avatar",children:"user"===e.role?m.jsx(E,{size:16}):m.jsx(k,{size:16})}),m.jsxs("div",{className:"message-bubble",children:[e.content&&m.jsx("p",{children:e.content}),"assistant"===e.role&&e.content&&!e.image&&m.jsx("button",{className:"msg-copy-btn",onClick:()=>v(e.content),title:"Copier le texte",children:m.jsx(b,{size:12})}),e.image&&m.jsxs("div",{className:"msg-image",children:[m.jsx("img",{src:e.image,alt:"Generated"}),m.jsx("a",{href:e.image,target:"_blank",rel:"noreferrer",children:"Télécharger"})]}),(null==(s=e.files)?void 0:s.length)>0&&m.jsx("div",{className:"msg-visuals",children:e.files.map((e,t)=>m.jsx("div",{className:"visual-preview",children:e.preview?m.jsx("img",{src:e.data,alt:"uploaded",className:"uploaded-thumb"}):m.jsxs("div",{className:"file-box",children:[m.jsx(w,{size:20}),m.jsx("span",{children:e.name})]})},t))})]})]},t)}),h&&m.jsxs("div",{className:"message-row assistant",children:[m.jsx("div",{className:"avatar",children:m.jsx(k,{size:16})}),m.jsxs("div",{className:"message-bubble",children:[m.jsx("p",{children:h}),m.jsx("span",{className:"cursor",children:"|"}),m.jsx("button",{className:"msg-copy-btn",onClick:()=>v(h),title:"Copier le texte",children:m.jsx(b,{size:12})})]})]}),o&&!h&&m.jsxs("div",{className:"message-row assistant",children:[m.jsx("div",{className:"avatar",children:m.jsx(k,{size:16})}),m.jsx("div",{className:"message-bubble loading",children:m.jsx(M,{className:"spin",size:20})})]}),m.jsx("div",{ref:g})]}),m.jsx("footer",{className:"chat-input-area",children:m.jsxs("form",{onSubmit:A,className:"input-wrap",children:[c.length>0&&m.jsx("div",{className:"previews",children:c.map((e,t)=>m.jsxs("div",{className:"preview-chip",children:[e.name,m.jsx(D,{size:14,onClick:()=>d(e=>e.filter((e,s)=>s!==t)),className:"cursor-pointer"})]},t))}),m.jsxs("div",{className:"input-row",children:[m.jsx("button",{type:"button",onClick:()=>f.current.click(),className:"attach-btn",children:m.jsx(S,{size:20})}),m.jsx("input",{type:"file",ref:f,onChange:e=>{Array.from(e.target.files).forEach(e=>{const t=new FileReader;t.onloadend=()=>{d(s=>[...s,{name:e.name,type:e.type,data:t.result,preview:e.type.startsWith("image/")?t.result:null}])},t.readAsDataURL(e)})},multiple:!0,className:"hidden"}),m.jsx("textarea",{value:i,onChange:e=>n(e.target.value),placeholder:"Écrivez votre message...",rows:1,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),A(e))}}),m.jsx("button",{type:"submit",className:"send-btn",disabled:o||!i&&!c.length,children:o?m.jsx(M,{className:"spin",size:20}):m.jsx(_,{size:20})})]})]})})]})]})}function I(){return m.jsx("div",{className:"app-container",children:m.jsx(T,{})})}p.createRoot(document.getElementById("root")).render(m.jsx(s.StrictMode,{children:m.jsx(I,{})}));
